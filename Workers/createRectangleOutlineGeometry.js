define(["./when-54c2dc71","./Check-6c0211bc","./Math-fc8cecf5","./Cartesian2-bddc1162","./Transforms-6f81ad4c","./RuntimeError-2109023a","./WebGLConstants-76bb35d1","./ComponentDatatype-6d99a1ee","./GeometryAttribute-700c1da0","./GeometryAttributes-4fcfcf40","./IndexDatatype-53503fee","./GeometryOffsetAttribute-7350d9af","./EllipsoidRhumbLine-c704bf4c","./PolygonPipeline-1aceedbc","./RectangleGeometryLibrary-db0b4615"],(function(e,t,i,a,r,n,o,l,u,s,c,d,p,f,g){"use strict";var h=new r.BoundingSphere,y=new r.BoundingSphere,m=new a.Cartesian3,b=new a.Rectangle;function _(e,t){var i=e._ellipsoid,a=t.height,r=t.width,n=t.northCap,o=a,d=2,p=0;e=4,n&&(--d,--o,p+=1,e-=2),(v=t.southCap)&&(--d,--o,p+=1,e-=2),p+=d*r+2*o-e;var f,h=new Float64Array(3*p),y=0,b=0,_=m;if(n)g.RectangleGeometryLibrary.computePosition(t,i,!1,b,0,_),h[y++]=_.x,h[y++]=_.y,h[y++]=_.z;else for(f=0;f<r;f++)g.RectangleGeometryLibrary.computePosition(t,i,!1,b,f,_),h[y++]=_.x,h[y++]=_.y,h[y++]=_.z;for(f=r-1,b=1;b<a;b++)g.RectangleGeometryLibrary.computePosition(t,i,!1,b,f,_),h[y++]=_.x,h[y++]=_.y,h[y++]=_.z;if(b=a-1,!v)for(f=r-2;0<=f;f--)g.RectangleGeometryLibrary.computePosition(t,i,!1,b,f,_),h[y++]=_.x,h[y++]=_.y,h[y++]=_.z;for(f=0,b=a-2;0<b;b--)g.RectangleGeometryLibrary.computePosition(t,i,!1,b,f,_),h[y++]=_.x,h[y++]=_.y,h[y++]=_.z;for(var v=h.length/3*2,E=c.IndexDatatype.createTypedArray(h.length/3,v),A=0,G=0;G<h.length/3-1;G++)E[A++]=G,E[A++]=G+1;return E[A++]=h.length/3-1,E[A++]=0,(v=new u.Geometry({attributes:new s.GeometryAttributes,primitiveType:u.PrimitiveType.LINES})).attributes.position=new u.GeometryAttribute({componentDatatype:l.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:h}),v.indices=E,v}function v(t){var r=(t=e.defaultValue(t,e.defaultValue.EMPTY_OBJECT)).rectangle,n=e.defaultValue(t.granularity,i.CesiumMath.RADIANS_PER_DEGREE),o=e.defaultValue(t.ellipsoid,a.Ellipsoid.WGS84),l=e.defaultValue(t.rotation,0),u=e.defaultValue(t.height,0),s=e.defaultValue(t.extrudedHeight,u);this._rectangle=a.Rectangle.clone(r),this._granularity=n,this._ellipsoid=o,this._surfaceHeight=Math.max(u,s),this._rotation=l,this._extrudedHeight=Math.min(u,s),this._offsetAttribute=t.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}v.packedLength=a.Rectangle.packedLength+a.Ellipsoid.packedLength+5,v.pack=function(t,i,r){return r=e.defaultValue(r,0),a.Rectangle.pack(t._rectangle,i,r),r+=a.Rectangle.packedLength,a.Ellipsoid.pack(t._ellipsoid,i,r),r+=a.Ellipsoid.packedLength,i[r++]=t._granularity,i[r++]=t._surfaceHeight,i[r++]=t._rotation,i[r++]=t._extrudedHeight,i[r]=e.defaultValue(t._offsetAttribute,-1),i};var E=new a.Rectangle,A=a.Ellipsoid.clone(a.Ellipsoid.UNIT_SPHERE),G={rectangle:E,ellipsoid:A,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};v.unpack=function(t,i,r){i=e.defaultValue(i,0);var n=a.Rectangle.unpack(t,i,E);i+=a.Rectangle.packedLength;var o=a.Ellipsoid.unpack(t,i,A);i+=a.Ellipsoid.packedLength;var l=t[i++],u=t[i++],s=t[i++],c=t[i++];return i=t[i],e.defined(r)?(r._rectangle=a.Rectangle.clone(n,r._rectangle),r._ellipsoid=a.Ellipsoid.clone(o,r._ellipsoid),r._surfaceHeight=u,r._rotation=s,r._extrudedHeight=c,r._offsetAttribute=-1===i?void 0:i,r):(G.granularity=l,G.height=u,G.rotation=s,G.extrudedHeight=c,G.offsetAttribute=-1===i?void 0:i,new v(G))};var R=new a.Cartographic;return v.createGeometry=function(t){var a=t._rectangle,n=t._ellipsoid,o=g.RectangleGeometryLibrary.computeOptions(a,t._granularity,t._rotation,0,b,R);if(!i.CesiumMath.equalsEpsilon(a.north,a.south,i.CesiumMath.EPSILON10)&&!i.CesiumMath.equalsEpsilon(a.east,a.west,i.CesiumMath.EPSILON10)){var s,p,m,v,E=t._surfaceHeight,A=t._extrudedHeight;return E=i.CesiumMath.equalsEpsilon(E,A,0,i.CesiumMath.EPSILON2)?((p=_(t,o)).attributes.position.values=f.PolygonPipeline.scaleToGeodeticHeight(p.attributes.position.values,E,n,!1),e.defined(t._offsetAttribute)&&(o=p.attributes.position.values.length,o=new Uint8Array(o/3),v=t._offsetAttribute===d.GeometryOffsetAttribute.NONE?0:1,d.arrayFill(o,v),p.attributes.applyOffset=new u.GeometryAttribute({componentDatatype:l.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:o})),r.BoundingSphere.fromRectangle3D(a,n,E)):(p=function(e,t){var i=e._surfaceHeight,a=e._extrudedHeight,r=e._ellipsoid,n=a,o=i,l=_(e,t),u=(a=t.height,i=t.width,(e=f.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,o,r,!1)).length);(o=new Float64Array(2*u)).set(e),n=f.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,n,r),o.set(n,u),l.attributes.position.values=o,r=t.northCap,n=t.southCap,t=4,r&&--t,n&&--t,t=2*(o.length/3+t);for(var s=c.IndexDatatype.createTypedArray(o.length/3,t),d=(u=o.length/6,0),p=0;p<u-1;p++)s[d++]=p,s[d++]=p+1,s[d++]=p+u,s[d++]=p+u+1;return s[d++]=u-1,s[d++]=0,s[d++]=u+u-1,s[d++]=u,s[d++]=0,s[d++]=u,a=r?a-1:(r=i-1,s[d++]=r,s[d++]=r+u,i+a-2),s[d++]=a,s[d++]=a+u,n||(a=i+a-1,s[d++]=a,s[d]=a+u),l.indices=s,l}(t,o),e.defined(t._offsetAttribute)&&(s=p.attributes.position.values.length/3,m=new Uint8Array(s),m=t._offsetAttribute===d.GeometryOffsetAttribute.TOP?d.arrayFill(m,1,0,s/2):(v=t._offsetAttribute===d.GeometryOffsetAttribute.NONE?0:1,d.arrayFill(m,v)),p.attributes.applyOffset=new u.GeometryAttribute({componentDatatype:l.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:m})),m=r.BoundingSphere.fromRectangle3D(a,n,E,y),A=r.BoundingSphere.fromRectangle3D(a,n,A,h),r.BoundingSphere.union(m,A)),new u.Geometry({attributes:p.attributes,indices:p.indices,primitiveType:u.PrimitiveType.LINES,boundingSphere:E,offsetAttribute:t._offsetAttribute})}},function(t,i){return e.defined(i)&&(t=v.unpack(t,i)),t._ellipsoid=a.Ellipsoid.clone(t._ellipsoid),t._rectangle=a.Rectangle.clone(t._rectangle),v.createGeometry(t)}}));