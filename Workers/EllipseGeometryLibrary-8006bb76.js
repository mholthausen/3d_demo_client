define(["exports","./Math-fc8cecf5","./Cartesian2-bddc1162","./Transforms-6f81ad4c"],(function(a,e,r,t){"use strict";var i={},n=new r.Cartesian3,s=new r.Cartesian3,o=new t.Quaternion,l=new t.Matrix3;function C(a,e,i,C,y,u,c,m,h,x){return e=a+e,r.Cartesian3.multiplyByScalar(C,Math.cos(e),n),r.Cartesian3.multiplyByScalar(i,Math.sin(e),s),r.Cartesian3.add(n,s,n),e=Math.cos(a),e*=e,a=Math.sin(a),a*=a,a=u/Math.sqrt(c*e+y*a)/m,t.Quaternion.fromAxisAngle(n,a,o),t.Matrix3.fromQuaternion(o,l),t.Matrix3.multiplyByVector(l,h,x),r.Cartesian3.normalize(x,x),r.Cartesian3.multiplyByScalar(x,m,x),x}var y=new r.Cartesian3,u=new r.Cartesian3,c=new r.Cartesian3,m=new r.Cartesian3;i.raisePositionsToHeight=function(a,e,t){for(var i=e.ellipsoid,n=e.height,s=e.extrudedHeight,o=(e=t?a.length/3*2:a.length/3,new Float64Array(3*e)),l=a.length,C=t?l:0,h=0;h<l;h+=3){var x=h+1,M=h+2,f=r.Cartesian3.fromArray(a,h,y);i.scaleToGeodeticSurface(f,f);var z=r.Cartesian3.clone(f,u),d=i.geodeticSurfaceNormal(f,m),_=r.Cartesian3.multiplyByScalar(d,n,c);r.Cartesian3.add(f,_,f),t&&(r.Cartesian3.multiplyByScalar(d,s,_),r.Cartesian3.add(z,_,z),o[h+C]=z.x,o[x+C]=z.y,o[M+C]=z.z),o[h]=f.x,o[x]=f.y,o[M]=f.z}return o};var h=new r.Cartesian3,x=new r.Cartesian3,M=new r.Cartesian3;i.computeEllipsePositions=function(a,t,i){var n=a.semiMinorAxis,s=a.semiMajorAxis,o=a.rotation,l=a.center,m=(a=8*a.granularity,n*n),f=s*s,z=s*n,d=r.Cartesian3.magnitude(l),_=r.Cartesian3.normalize(l,h),O=r.Cartesian3.cross(r.Cartesian3.UNIT_Z,l,x),p=(O=r.Cartesian3.normalize(O,O),r.Cartesian3.cross(_,O,M)),w=1+Math.ceil(e.CesiumMath.PI_OVER_TWO/a),P=e.CesiumMath.PI_OVER_TWO/(w-1),T=e.CesiumMath.PI_OVER_TWO-w*P;T<0&&(w-=Math.ceil(Math.abs(T)/P));var I,g,v,E,V,A=t?new Array(w*(w+2)*2*3):void 0,R=0,W=y,S=u,B=(a=4*w*3)-1,b=0,Q=i?new Array(a):void 0;for(W=C(T=e.CesiumMath.PI_OVER_TWO,o,p,O,m,z,f,d,_,W),t&&(A[R++]=W.x,A[R++]=W.y,A[R++]=W.z),i&&(Q[B--]=W.z,Q[B--]=W.y,Q[B--]=W.x),T=e.CesiumMath.PI_OVER_TWO-P,I=1;I<w+1;++I){if(W=C(T,o,p,O,m,z,f,d,_,W),S=C(Math.PI-T,o,p,O,m,z,f,d,_,S),t){for(A[R++]=W.x,A[R++]=W.y,A[R++]=W.z,v=2*I+2,g=1;g<v-1;++g)E=g/(v-1),V=r.Cartesian3.lerp(W,S,E,c),A[R++]=V.x,A[R++]=V.y,A[R++]=V.z;A[R++]=S.x,A[R++]=S.y,A[R++]=S.z}i&&(Q[B--]=W.z,Q[B--]=W.y,Q[B--]=W.x,Q[b++]=S.x,Q[b++]=S.y,Q[b++]=S.z),T=e.CesiumMath.PI_OVER_TWO-(I+1)*P}for(I=w;1<I;--I){if(W=C(-(T=e.CesiumMath.PI_OVER_TWO-(I-1)*P),o,p,O,m,z,f,d,_,W),S=C(T+Math.PI,o,p,O,m,z,f,d,_,S),t){for(A[R++]=W.x,A[R++]=W.y,A[R++]=W.z,v=2*(I-1)+2,g=1;g<v-1;++g)E=g/(v-1),V=r.Cartesian3.lerp(W,S,E,c),A[R++]=V.x,A[R++]=V.y,A[R++]=V.z;A[R++]=S.x,A[R++]=S.y,A[R++]=S.z}i&&(Q[B--]=W.z,Q[B--]=W.y,Q[B--]=W.x,Q[b++]=S.x,Q[b++]=S.y,Q[b++]=S.z)}return W=C(-(T=e.CesiumMath.PI_OVER_TWO),o,p,O,m,z,f,d,_,W),a={},t&&(A[R++]=W.x,A[R++]=W.y,A[R++]=W.z,a.positions=A,a.numPts=w),i&&(Q[B--]=W.z,Q[B--]=W.y,Q[B--]=W.x,a.outerPositions=Q),a},a.EllipseGeometryLibrary=i}));