define(["./GeometryOffsetAttribute-d889f085","./arrayRemoveDuplicates-216006b0","./Transforms-e9dbfb40","./Cartesian2-49b1de22","./Check-6c0211bc","./ComponentDatatype-6d99a1ee","./PolylineVolumeGeometryLibrary-8f28f929","./CorridorGeometryLibrary-87f97344","./when-54c2dc71","./GeometryAttribute-669569db","./GeometryAttributes-4fcfcf40","./IndexDatatype-46306178","./Math-44e92d6b","./PolygonPipeline-72c97573","./RuntimeError-2109023a","./WebGLConstants-76bb35d1","./EllipsoidTangentPlane-c4704d0f","./IntersectionTests-6ead8677","./Plane-8f7e53d1","./PolylinePipeline-eb80587e","./EllipsoidGeodesic-a2d57ae0","./EllipsoidRhumbLine-9b557f71"],(function(e,t,i,r,o,a,n,s,l,d,u,p,f,h,y,c,g,b,m,v,A,_){"use strict";var E=new r.Cartesian3,C=new r.Cartesian3,G=new r.Cartesian3;function T(e,t){var i,o=[],f=e.positions,h=e.corners,y=e.endPositions,c=new u.GeometryAttributes,g=0,b=0,m=0;for(M=0;M<f.length;M+=2)g+=i=f[M].length-3,m+=i/3*4,b+=f[M+1].length-3;for(g+=3,b+=3,M=0;M<h.length;M++){Y=h[M];var v=h[M].leftPositions;l.defined(v)?g+=i=v.length:b+=i=h[M].rightPositions.length,m+=i/3*2}var A,_=l.defined(y);_&&(g+=A=y[0].length-3,b+=A,m+=4*(A/=3)),e=g+b;var T,P,w,L,D,k,N=new Float64Array(e),O=0,V=e-1,x=A/2,H=p.IndexDatatype.createTypedArray(e/3,m+4),I=0;if(H[I++]=O/3,H[I++]=(V-2)/3,_){o.push(O/3),k=E,D=C;for(var S=y[0],M=0;M<x;M++)k=r.Cartesian3.fromArray(S,3*(x-1-M),k),D=r.Cartesian3.fromArray(S,3*(x+M),D),s.CorridorGeometryLibrary.addAttribute(N,D,O),s.CorridorGeometryLibrary.addAttribute(N,k,void 0,V),L=1+(P=O/3),w=(T=(V-2)/3)-1,H[I++]=T,H[I++]=w,H[I++]=P,H[I++]=L,O+=3,V-=3}var R=0,B=f[R++],U=f[R++];for(N.set(B,O),N.set(U,V-U.length+1),i=U.length-3,o.push(O/3,(V-2)/3),M=0;M<i;M+=3)L=1+(P=O/3),w=(T=(V-2)/3)-1,H[I++]=T,H[I++]=w,H[I++]=P,H[I++]=L,O+=3,V-=3;for(M=0;M<h.length;M++){var F,Y,q,W=(Y=h[M]).leftPositions,J=Y.rightPositions,j=G;if(l.defined(W)){for(V-=3,q=w,o.push(L),F=0;F<W.length/3;F++)j=r.Cartesian3.fromArray(W,3*F,j),H[I++]=q-F-1,H[I++]=q-F,s.CorridorGeometryLibrary.addAttribute(N,j,void 0,V),V-=3;o.push(q-Math.floor(W.length/6)),t===n.CornerType.BEVELED&&o.push((V-2)/3+1),O+=3}else{for(O+=3,q=L,o.push(w),F=0;F<J.length/3;F++)j=r.Cartesian3.fromArray(J,3*F,j),H[I++]=q+F,H[I++]=q+F+1,s.CorridorGeometryLibrary.addAttribute(N,j,O),O+=3;o.push(q+Math.floor(J.length/6)),t===n.CornerType.BEVELED&&o.push(O/3-1),V-=3}for(B=f[R++],U=f[R++],B.splice(0,3),U.splice(U.length-3,3),N.set(B,O),N.set(U,V-U.length+1),i=U.length-3,F=0;F<U.length;F+=3)P=(L=O/3)-1,T=1+(w=(V-2)/3),H[I++]=T,H[I++]=w,H[I++]=P,H[I++]=L,O+=3,V-=3;O-=3,V+=3,o.push(O/3,(V-2)/3)}if(_){O+=3,V-=3,k=E,D=C;var z=y[1];for(M=0;M<x;M++)k=r.Cartesian3.fromArray(z,3*(A-M-1),k),D=r.Cartesian3.fromArray(z,3*M,D),s.CorridorGeometryLibrary.addAttribute(N,k,void 0,V),s.CorridorGeometryLibrary.addAttribute(N,D,O),P=(L=O/3)-1,T=1+(w=(V-2)/3),H[I++]=T,H[I++]=w,H[I++]=P,H[I++]=L,O+=3,V-=3;o.push(O/3)}else o.push(O/3,(V-2)/3);return H[I++]=O/3,H[I++]=(V-2)/3,c.position=new d.GeometryAttribute({componentDatatype:a.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:N}),{attributes:c,indices:H,wallIndices:o}}function P(e){var t=(e=l.defaultValue(e,l.defaultValue.EMPTY_OBJECT)).positions,i=e.width,o=l.defaultValue(e.height,0),a=l.defaultValue(e.extrudedHeight,o);this._positions=t,this._ellipsoid=r.Ellipsoid.clone(l.defaultValue(e.ellipsoid,r.Ellipsoid.WGS84)),this._width=i,this._height=Math.max(o,a),this._extrudedHeight=Math.min(o,a),this._cornerType=l.defaultValue(e.cornerType,n.CornerType.ROUNDED),this._granularity=l.defaultValue(e.granularity,f.CesiumMath.RADIANS_PER_DEGREE),this._offsetAttribute=e.offsetAttribute,this._workerName="createCorridorOutlineGeometry",this.packedLength=1+t.length*r.Cartesian3.packedLength+r.Ellipsoid.packedLength+6}P.pack=function(e,t,i){i=l.defaultValue(i,0);var o=e._positions,a=o.length;t[i++]=a;for(var n=0;n<a;++n,i+=r.Cartesian3.packedLength)r.Cartesian3.pack(o[n],t,i);return r.Ellipsoid.pack(e._ellipsoid,t,i),i+=r.Ellipsoid.packedLength,t[i++]=e._width,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._cornerType,t[i++]=e._granularity,t[i]=l.defaultValue(e._offsetAttribute,-1),t};var w=r.Ellipsoid.clone(r.Ellipsoid.UNIT_SPHERE),L={positions:void 0,ellipsoid:w,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,offsetAttribute:void 0};return P.unpack=function(e,t,i){t=l.defaultValue(t,0);for(var o=e[t++],a=new Array(o),n=0;n<o;++n,t+=r.Cartesian3.packedLength)a[n]=r.Cartesian3.unpack(e,t);var s=r.Ellipsoid.unpack(e,t,w);t+=r.Ellipsoid.packedLength;var d=e[t++],u=e[t++],p=e[t++],f=e[t++],h=e[t++],y=e[t];return l.defined(i)?(i._positions=a,i._ellipsoid=r.Ellipsoid.clone(s,i._ellipsoid),i._width=d,i._height=u,i._extrudedHeight=p,i._cornerType=f,i._granularity=h,i._offsetAttribute=-1===y?void 0:y,i):(L.positions=a,L.width=d,L.height=u,L.extrudedHeight=p,L.cornerType=f,L.granularity=h,L.offsetAttribute=-1===y?void 0:y,new P(L))},P.createGeometry=function(o){var n=o._positions,u=o._width,y=o._ellipsoid,c=(n=function(e,t){for(var i=0;i<e.length;i++)e[i]=t.scaleToGeodeticSurface(e[i],e[i]);return e}(n,y),t.arrayRemoveDuplicates(n,r.Cartesian3.equalsEpsilon));if(!(c.length<2||u<=0)){var g,b=o._height,m=o._extrudedHeight;n=!f.CesiumMath.equalsEpsilon(b,m,0,f.CesiumMath.EPSILON2),u={ellipsoid:y,positions:c,width:u,cornerType:o._cornerType,granularity:o._granularity,saveAttributes:!1},n?(u.height=b,u.extrudedHeight=m,u.offsetAttribute=o._offsetAttribute,g=function(t){var i=t.ellipsoid,r=(c=T(s.CorridorGeometryLibrary.computePositions(t),t.cornerType)).wallIndices,o=t.height,n=t.extrudedHeight,u=c.attributes,f=c.indices,y=(g=u.position.values).length;(b=new Float64Array(y)).set(g);var c=new Float64Array(2*y),g=h.PolygonPipeline.scaleToGeodeticHeight(g,o,i),b=h.PolygonPipeline.scaleToGeodeticHeight(b,n,i);c.set(g),c.set(b,y),u.position.values=c,y/=3,l.defined(t.offsetAttribute)&&(b=new Uint8Array(2*y),b=t.offsetAttribute===e.GeometryOffsetAttribute.TOP?e.arrayFill(b,1,0,y):(t=t.offsetAttribute===e.GeometryOffsetAttribute.NONE?0:1,e.arrayFill(b,t)),u.applyOffset=new d.GeometryAttribute({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:b}));var m=f.length,v=p.IndexDatatype.createTypedArray(c.length/3,2*(m+r.length));v.set(f);for(var A,_,E=m,C=0;C<m;C+=2){var G=f[C],P=f[C+1];v[E++]=G+y,v[E++]=P+y}for(C=0;C<r.length;C++)_=(A=r[C])+y,v[E++]=A,v[E++]=_;return{attributes:u,indices:v}}(u)):((g=T(s.CorridorGeometryLibrary.computePositions(u),u.cornerType)).attributes.position.values=h.PolygonPipeline.scaleToGeodeticHeight(g.attributes.position.values,b,y),l.defined(o._offsetAttribute)&&(v=g.attributes.position.values.length,A=new Uint8Array(v/3),v=o._offsetAttribute===e.GeometryOffsetAttribute.NONE?0:1,e.arrayFill(A,v),g.attributes.applyOffset=new d.GeometryAttribute({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:A})));var v=g.attributes,A=i.BoundingSphere.fromVertices(v.position.values,void 0,3);return new d.Geometry({attributes:v,indices:g.indices,primitiveType:d.PrimitiveType.LINES,boundingSphere:A,offsetAttribute:o._offsetAttribute})}},function(e,t){return(e=l.defined(t)?P.unpack(e,t):e)._ellipsoid=r.Ellipsoid.clone(e._ellipsoid),P.createGeometry(e)}}));