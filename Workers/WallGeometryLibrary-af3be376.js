define(["exports","./when-54c2dc71","./Math-fc8cecf5","./Cartesian2-bddc1162","./arrayRemoveDuplicates-ebc732b0","./PolylinePipeline-7685bebd"],(function(e,i,t,r,n,a){"use strict";var o={},l=new r.Cartographic,s=new r.Cartographic,h=new Array(2),g=new Array(2),c={positions:void 0,height:void 0,granularity:void 0,ellipsoid:void 0};o.computePositions=function(e,o,p,u,d,y){var m=function(e,a,o,h){var g=(a=n.arrayRemoveDuplicates(a,r.Cartesian3.equalsEpsilon)).length;if(!(g<2)){var c=i.defined(h),p=i.defined(o),u=new Array(g),d=new Array(g),y=new Array(g),m=a[0];u[0]=m;var v=e.cartesianToCartographic(m,l);p&&(v.height=o[0]),d[0]=v.height,y[0]=c?h[0]:0;for(var P,f,A=d[0]===y[0],C=1,w=1;w<g;++w){var b=a[w],M=e.cartesianToCartographic(b,s);p&&(M.height=o[w]),A=A&&0===M.height,P=v,f=M,t.CesiumMath.equalsEpsilon(P.latitude,f.latitude,t.CesiumMath.EPSILON10)&&t.CesiumMath.equalsEpsilon(P.longitude,f.longitude,t.CesiumMath.EPSILON10)?v.height<M.height&&(d[C-1]=M.height):(u[C]=b,d[C]=M.height,y[C]=c?h[w]:0,A=A&&d[C]===y[C],r.Cartographic.clone(M,v),++C)}if(!(A||C<2))return u.length=C,d.length=C,y.length=C,{positions:u,topHeights:d,bottomHeights:y}}}(e,o,p,u);if(i.defined(m)){o=m.positions,p=m.topHeights,u=m.bottomHeights;var v,P,f=o.length,A=(m=f-2,t.CesiumMath.chordLength(d,e.maximumRadius)),C=c;if(C.minDistance=A,C.ellipsoid=e,y){for(var w=0,b=0;b<f-1;b++)w+=a.PolylinePipeline.numberOfPoints(o[b],o[b+1],A)+1;v=new Float64Array(3*w),P=new Float64Array(3*w);var M=h,E=g;C.positions=M,C.height=E;var F=0;for(b=0;b<f-1;b++){M[0]=o[b],M[1]=o[b+1],E[0]=p[b],E[1]=p[b+1];var H=a.PolylinePipeline.generateArc(C);v.set(H,F),E[0]=u[b],E[1]=u[b+1],P.set(a.PolylinePipeline.generateArc(C),F),F+=H.length}}else C.positions=o,C.height=p,v=new Float64Array(a.PolylinePipeline.generateArc(C)),C.height=u,P=new Float64Array(a.PolylinePipeline.generateArc(C));return{bottomPositions:P,topPositions:v,numCorners:m}}},e.WallGeometryLibrary=o}));