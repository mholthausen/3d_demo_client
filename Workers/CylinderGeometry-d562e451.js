define(["exports","./when-54c2dc71","./Check-6c0211bc","./Math-fc8cecf5","./Cartesian2-bddc1162","./Transforms-6f81ad4c","./ComponentDatatype-6d99a1ee","./GeometryAttribute-700c1da0","./GeometryAttributes-4fcfcf40","./IndexDatatype-53503fee","./GeometryOffsetAttribute-7350d9af","./VertexFormat-7572c785","./CylinderGeometryLibrary-b0214ab1"],(function(t,e,a,r,n,o,i,s,m,u,d,f,p){"use strict";var y=new n.Cartesian2,c=new n.Cartesian3,l=new n.Cartesian3,b=new n.Cartesian3,v=new n.Cartesian3;function A(t){var a=(t=e.defaultValue(t,e.defaultValue.EMPTY_OBJECT)).length,r=t.topRadius,n=t.bottomRadius,o=e.defaultValue(t.vertexFormat,f.VertexFormat.DEFAULT),i=e.defaultValue(t.slices,128);this._length=a,this._topRadius=r,this._bottomRadius=n,this._vertexFormat=f.VertexFormat.clone(o),this._slices=i,this._offsetAttribute=t.offsetAttribute,this._workerName="createCylinderGeometry"}A.packedLength=f.VertexFormat.packedLength+5,A.pack=function(t,a,r){return r=e.defaultValue(r,0),f.VertexFormat.pack(t._vertexFormat,a,r),r+=f.VertexFormat.packedLength,a[r++]=t._length,a[r++]=t._topRadius,a[r++]=t._bottomRadius,a[r++]=t._slices,a[r]=e.defaultValue(t._offsetAttribute,-1),a};var g,h=new f.VertexFormat,x={vertexFormat:h,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};A.unpack=function(t,a,r){a=e.defaultValue(a,0);var n=f.VertexFormat.unpack(t,a,h);a+=f.VertexFormat.packedLength;var o=t[a++],i=t[a++],s=t[a++],m=t[a++];return a=t[a],e.defined(r)?(r._vertexFormat=f.VertexFormat.clone(n,r._vertexFormat),r._length=o,r._topRadius=i,r._bottomRadius=s,r._slices=m,r._offsetAttribute=-1===a?void 0:a,r):(x.length=o,x.topRadius=i,x.bottomRadius=s,x.slices=m,x.offsetAttribute=-1===a?void 0:a,new A(x))},A.createGeometry=function(t){var a=t._length,f=t._topRadius,A=t._bottomRadius,g=t._vertexFormat,h=t._slices;if(!(a<=0||f<0||A<0||0===f&&0===A)){var x=h+h,_=h+x,C=x+x,F=p.CylinderGeometryLibrary.computePositions(a,f,A,h,!0),w=g.st?new Float32Array(2*C):void 0,G=g.normal?new Float32Array(3*C):void 0,D=g.tangent?new Float32Array(3*C):void 0,R=g.bitangent?new Float32Array(3*C):void 0,V=g.normal||g.tangent||g.bitangent;if(V){var T=g.tangent||g.bitangent,O=0,L=0,P=0,k=Math.atan2(A-f,a),M=c;M.z=Math.sin(k);for(var z=Math.cos(k),E=b,N=l,I=0;I<h;I++){var U=I/h*r.CesiumMath.TWO_PI,S=z*Math.cos(U);U=z*Math.sin(U),V&&(M.x=S,M.y=U,T&&(E=n.Cartesian3.normalize(n.Cartesian3.cross(n.Cartesian3.UNIT_Z,M,E),E)),g.normal&&(G[O++]=M.x,G[O++]=M.y,G[O++]=M.z,G[O++]=M.x,G[O++]=M.y,G[O++]=M.z),g.tangent&&(D[L++]=E.x,D[L++]=E.y,D[L++]=E.z,D[L++]=E.x,D[L++]=E.y,D[L++]=E.z),g.bitangent&&(N=n.Cartesian3.normalize(n.Cartesian3.cross(M,E,N),N),R[P++]=N.x,R[P++]=N.y,R[P++]=N.z,R[P++]=N.x,R[P++]=N.y,R[P++]=N.z))}for(I=0;I<h;I++)g.normal&&(G[O++]=0,G[O++]=0,G[O++]=-1),g.tangent&&(D[L++]=1,D[L++]=0,D[L++]=0),g.bitangent&&(R[P++]=0,R[P++]=-1,R[P++]=0);for(I=0;I<h;I++)g.normal&&(G[O++]=0,G[O++]=0,G[O++]=1),g.tangent&&(D[L++]=1,D[L++]=0,D[L++]=0),g.bitangent&&(R[P++]=0,R[P++]=1,R[P++]=0)}k=12*h-12;var B=u.IndexDatatype.createTypedArray(C,k),Y=0,Z=0;for(I=0;I<h-1;I++)B[Y++]=Z,B[Y++]=Z+2,B[Y++]=Z+3,B[Y++]=Z,B[Y++]=Z+3,B[Y++]=Z+1,Z+=2;for(B[Y++]=x-2,B[Y++]=0,B[Y++]=1,B[Y++]=x-2,B[Y++]=1,B[Y++]=x-1,I=1;I<h-1;I++)B[Y++]=x+I+1,B[Y++]=x+I,B[Y++]=x;for(I=1;I<h-1;I++)B[Y++]=_,B[Y++]=_+I,B[Y++]=_+I+1;var J=0;if(g.st){var W=Math.max(f,A);for(I=0;I<C;I++){var j=n.Cartesian3.fromArray(F,3*I,v);w[J++]=(j.x+W)/(2*W),w[J++]=(j.y+W)/(2*W)}}return k=new m.GeometryAttributes,g.position&&(k.position=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:F})),g.normal&&(k.normal=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:G})),g.tangent&&(k.tangent=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:D})),g.bitangent&&(k.bitangent=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:R})),g.st&&(k.st=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:w})),y.x=.5*a,y.y=Math.max(A,f),A=new o.BoundingSphere(n.Cartesian3.ZERO,n.Cartesian2.magnitude(y)),e.defined(t._offsetAttribute)&&(a=F.length,f=new Uint8Array(a/3),a=t._offsetAttribute===d.GeometryOffsetAttribute.NONE?0:1,d.arrayFill(f,a),k.applyOffset=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:f})),new s.Geometry({attributes:k,indices:B,primitiveType:s.PrimitiveType.TRIANGLES,boundingSphere:A,offsetAttribute:t._offsetAttribute})}},A.getUnitCylinder=function(){return e.defined(g)||(g=A.createGeometry(new A({topRadius:1,bottomRadius:1,length:1,vertexFormat:f.VertexFormat.POSITION_ONLY}))),g},t.CylinderGeometry=A}));